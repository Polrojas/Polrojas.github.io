<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Subir archivo a S3</title>
        <script> 
            function _(el){
                return document.getElementById(el);
            }
            function uploadFile(){
                var file = (file1).files[0];
                var formdata = new FormData();
                formdata.append("file1", file);
                var ajax = new XMLHttpRequest();
                ajax.upload.addEventListener("progress", progressHandler, false);
                ajax.addEventListener("load", completeHandler, false);
                ajax.addEventListener("error", errorHandler, false);
                ajax.addEventListener("abort", abortHandler, false);
                ajax.open("POST", "apiRes/imagen.php");
                ajax.send(formdata);
            }
            function progressHandler(event){
                _("loaded_n_total").innerHTML = "Uploaded " + event.loaded + " bytes of ";
                var percent = (event.loaded / event.total) * 100;
                _("progressBar").value = Math.round(percent);
                _("status").innerHTML = Math.round(percent) + "% progreso ... Aguarde";                
            }
            function completeHandler(event){
                _("status").innerHTML = event.target.responseText;
                _("progressBar").value = 0;                
            }
            function errorHandler(event){
                _("status").innerHTML = "Upload Failed";
            }
            function abortHandler(event){
                _("status").innerHTML = "upload Aborted";
            }
        </script>
    </head>

    <body>

        <header>
            <h1>Se selecciona el archivo para subir al bucket</h1>
        </header>

		<div class="preview done">
			<form id="upload_form" method="post" enctype="multipart/form-data">
				<input type="file" name="file1" id="file1" /><br>
				<input type="button" value="Upload File" onclick="uploadFile()" />
                <progress id="progressBar" value=0 max="100" style="width:300 px;"></progress>
                <h3 id="status"></h3>
                <p id = "loaded_n_total"></p>
			</form>
		</div>
    </body>
</html>